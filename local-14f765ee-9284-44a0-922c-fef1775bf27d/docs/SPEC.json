{"ui": {"feedback": ["Highlight valid moves", "Animate AI move", "Show AI thinking state", "Display winner/loser message"], "board_style": {"cell_size": 48, "disc_colors": {"pest": "#555555", "outline": "#aaaaaa", "crop_type_1": "#4CAF50", "crop_type_2": "#8BC34A", "crop_type_3": "#FFC107", "crop_type_4": "#9C27B0"}, "flip_animation": {"enabled": true, "duration_ms": 180}, "grid_line_color": "#333333", "last_move_highlight": {"color": "#ffcc00", "enabled": true}, "valid_move_highlight": {"color": "#66ccff", "enabled": true}}, "interactions": ["Click/tap to perform a move", "Drag to slide, tap to flip, hover for previews", "Keyboard navigation with ARIA focus"], "display_elements": ["Board/game area", "Current player indicator (You vs AI)", "AI thinking indicator", "Game status message", "Restart button"]}, "meta": {"players": {"ai": 1, "human": 1}, "game_name": "Farm Field Flip", "game_type": "board", "player_mode": "player_vs_ai", "core_mechanic": "On a 6x6 grid, players flip or slide crop tokens to align full rows of identical vegetables while the AI farmer introduces pests as obstacles to avoid.", "session_minutes": [10, 20]}, "rules": [{"id": "R1", "text": "Clear, testable rule with input/output (MUST / SHOULD / MAY).", "type": "core|validation|optional"}, {"id": "R_AI_1", "text": "AI MUST make a move within 2 seconds of its turn starting.", "type": "core"}, {"id": "R_AI_2", "text": "AI with difficulty 'easy' MUST use a simple deterministic pest-placement heuristic.", "type": "core"}, {"id": "R_AI_3", "text": "AI with difficulty 'medium' MUST use a moderate heuristic balancing pest placement and block strategies.", "type": "core"}, {"id": "R_AI_4", "text": "AI with difficulty 'hard' MUST use an advanced planning algorithm with lookahead.", "type": "core"}], "state": {"board": {"type": "grid", "topology": "square", "neighbors": ["up", "down", "left", "right"], "dimensions": [6, 6]}, "entities": [{"name": "Player", "properties": {"id": "1", "type": "human", "color": "#228B22", "pieces_played": 0}, "initial_state": {"pieces_played": 0}}, {"name": "AI", "properties": {"depth": 4, "algorithm": "minimax", "difficulty": "medium", "is_thinking": false, "response_delay_ms": 500}, "initial_state": {"depth": 4, "algorithm": "minimax", "difficulty": "medium", "is_thinking": false, "response_delay_ms": 500}}, {"name": "Board", "properties": {"cols": 6, "grid": "2D array of cells with occupantId or null and tile type (crop or pest)", "rows": 6}, "initial_state": {}}, {"name": "Game", "properties": {"status": "string (playing|human_wins|ai_wins|draw)", "last_move": "object", "move_count": "int", "current_player": "int (1 or 2)"}, "initial_state": {"status": "playing", "move_count": 0, "current_player": 1}}]}, "turns": {"order": "Human (Player 1) → AI (Player 2) → repeat", "actions": [{"name": "player_move", "result": "Apply mechanics.move_validation and mechanics.capture; update state; switch to AI; check end conditions", "condition": "current_player == 1 AND game.status == playing AND a legal move exists", "parameters": ["row", "col", "actionType (slide|flip)", "targetRow|targetCol (for slide)"]}, {"name": "ai_move", "result": "AI calculates move using algorithm; apply mechanics.move_validation and mechanics.capture; update state; switch to human; check end conditions", "condition": "current_player == 2 AND game.status == playing", "parameters": []}, {"name": "restart", "result": "Reset all state to initial values", "condition": "game.status != playing", "parameters": []}], "max_time_seconds": 30}, "config": {"show_ai_thinking": true, "default_difficulty": "medium", "ai_response_delay_ms": 500, "allow_difficulty_change": true}, "mechanics": {"setup": {"initial_placement": "Starting distribution of crop tokens across the 6x6 grid is provided by deterministic seed; no pests present at start.", "starting_player_rule": "human"}, "capture": {"type": "none", "result": "No capture events; progress driven by pattern completion and pest placement", "directions": [], "chain_capture": false, "min_chain_length": 0, "require_sandwich": false, "capture_algorithm": {"name": "none", "steps": [], "inputs": [], "outputs": {}, "parameters": {}}}, "scoring": {"method": "pattern_completion", "winner_determination": "Human wins if any row (6 cells) contains identical crop tokens with no pests in that row; AI wins if a full row of Pest obstacles appears or if draw conditions occur without human victory"}, "movement": {"range": "1 for both slide and flip (single-tile interactions)", "allowed": "slide|flip", "directions": ["up", "down", "left", "right"]}, "turn_flow": {"switch_after_move": true, "extra_turn_conditions": "end game after two consecutive passes", "pass_if_no_valid_move": true}, "move_validation": {"validity_checks": ["destination is within board bounds", "destination is adjacent for slide or is the same cell for a flip action target", "target cell is empty for slides; flip targets a tile to a different vegetable type", "flip result must be a valid vegetable state (e.g., cycle within allowed types)"], "must_place_on_empty": true, "validation_algorithm": {"name": "adjacency_check", "steps": ["Clamp coordinates to board bounds", "Verify destination is adjacent for slide or valid flip target", "Ensure destination cell is empty (for slide) or that flip result is allowed", "If flip, compute next vegetable type and ensure legality"], "inputs": ["row", "col", "current_player", "board"], "outputs": {"preview": "object or array if applicable", "is_valid": true}, "parameters": {"gravity": false, "directions": ["up", "down", "left", "right"], "require_bounded": false, "min_chain_length": 0}}}}, "technical": {"platform": "HTML5 Canvas", "modularity": {"ui_split": true}, "performance": {"target_fps": 30, "max_load_time_ms": 1000, "max_ai_think_time_ms": 2000}, "accessibility": {"aria_live": true, "aria_labels": true}}, "acceptance": [{"then": "Expected result with specific values", "when": "Human action performed", "given": "Initial state description"}, {"then": "State updates deterministically; last_move recorded; AI turn begins", "when": "Player performs a valid move", "given": "A valid move exists per game rules"}, {"then": "AI uses simple deterministic pest-placement within 2 seconds", "when": "AI calculates move", "given": "AI's turn, difficulty='easy'"}, {"then": "Human wins and modal displays", "when": "Human achieves a full matching row", "given": "Human can win by row completion"}, {"then": "AI wins and modal displays", "when": "AI forms a full Pest row", "given": "AI blocks all winning paths"}], "end_conditions": {"win": [{"priority": "immediate", "condition": "Human completes a full row of identical vegetables with no pests in that row", "check_logic": "At end of a turn, scan all 6 rows; if any row contains six tokens of the same vegetable type and zero Pest tokens, human_wins"}], "draw": [{"priority": "end_turn", "condition": "No legal moves exist for both players for an entire round", "check_logic": "After a full pass cycle with no changes, trigger draw"}, {"priority": "end_turn", "condition": "Move limit reached without a winner", "check_logic": "If move_count >= 200, declare draw"}], "lose": [{"priority": "immediate", "condition": "AI forms a full Pest row (one entire row occupied by Pest tokens)", "check_logic": "Scan all rows; if any row consists entirely of Pest tokens, ai_wins"}, {"priority": "end_turn", "condition": "Time or no legal moves lead to end", "check_logic": "If both players have no legal moves for a full round, declare draw unless a win condition is met"}]}}