{"ui": {"feedback": ["Highlight valid moves", "Animate AI move", "Show AI thinking state", "Display winner message"], "board_style": {"cell_size": 48, "disc_colors": {"outline": "#aaaaaa", "player_1": "#0a0a0a", "player_2": "#f0f0f0"}, "flip_animation": {"enabled": true, "duration_ms": 180}, "grid_line_color": "#333333", "last_move_highlight": {"color": "#ffcc00", "enabled": true}, "valid_move_highlight": {"color": "#66ccff", "enabled": true}}, "interactions": ["Click/tap to select card(s) and destination", "Drag-and-drop or click-to-move sequences", "Hover for hints", "Click restart button"], "display_elements": ["Board area (tableau, stock, waste, foundations)", "Current player indicator (You vs AI)", "AI thinking indicator", "Status banner / message", "Restart button"]}, "meta": {"players": {"ai": 1, "human": 1}, "game_name": "Solitaire Studio", "game_type": "board", "player_mode": "player_vs_ai", "core_mechanic": "A compact Klondike-style solitaire on a grid where the player moves exposed tableau cards and stock/waste to build four foundations in order; AI turns operate on a fixed-seed, deterministic strategy.", "session_minutes": [10, 60]}, "rules": [{"id": "R1", "text": "Clear, testable rule with input/output (MUST/SHOULD/CAN).", "type": "core|validation|optional"}, {"id": "R_AI_1", "text": "AI MUST make a move within 2 seconds of its turn starting.", "type": "core"}, {"id": "R_AI_2", "text": "AI with difficulty 'easy' MUST use a simple heuristic that chooses the first legal move.", "type": "core"}, {"id": "R_AI_3", "text": "AI with difficulty 'medium' MUST use a rule-based strategy prioritizing foundational moves and exposing new tableau cards.", "type": "core"}, {"id": "R_AI_4", "text": "AI with difficulty 'hard' MUST use an advanced search with pruning to maximize foundation progress within depth limits.", "type": "core"}], "state": {"board": {"type": "grid", "topology": "square", "neighbors": ["up", "down", "left", "right"], "dimensions": [7, 9]}, "entities": [{"name": "Player", "properties": {"id": 1, "type": "human", "color": "green", "owner_id": 1, "pieces_played": 0}, "initial_state": {"pieces_played": 0}}, {"name": "AI", "properties": {"id": 2, "type": "ai", "depth": 0, "owner_id": 2, "algorithm": "rule_based", "difficulty": "medium", "is_thinking": false, "response_delay_ms": 500}, "initial_state": {"id": 2, "type": "ai", "depth": 0, "owner_id": 2, "algorithm": "rule_based", "difficulty": "medium", "is_thinking": false, "response_delay_ms": 500}}, {"name": "Board", "properties": {"cols": 9, "grid": "rectangular 7x9 representation containing foundation slots, stock, waste, and 7 tableau piles as stacked piles", "rows": 7}, "initial_state": {}}, {"name": "Game", "properties": {"status": "playing", "last_move": {}, "move_count": 0, "current_player": 1}, "initial_state": {"status": "playing", "move_count": 0, "current_player": 1}}], "turn_mode": "sequential", "allegiance": "none", "randomness": {"type": "deterministic", "seed_source": "server_seed"}, "board_present": true, "physics_context": "static", "holdings_present": true}, "turns": {"order": "Human (Player 1) → AI (Player 2) → repeat", "actions": [{"name": "player_move", "result": "Apply mechanics.move_validation and mechanics.capture; update state; switch to AI; check end conditions", "condition": "current_player == 1 AND game.status == playing AND move is valid", "parameters": ["source", "destination"]}, {"name": "ai_move", "result": "AI calculates move using algorithm; apply mechanics.move_validation and mechanics.capture; update state; switch to human; check end conditions", "condition": "current_player == 2 AND game.status == playing", "parameters": []}, {"name": "restart", "result": "Reset all state to initial values", "condition": "game.status != playing", "parameters": []}], "max_time_seconds": 30}, "config": {"show_ai_thinking": true, "default_difficulty": "medium", "ai_response_delay_ms": 500, "allow_difficulty_change": true}, "mechanics": {"setup": {"initial_placement": "Klondike-style: 7 tableau piles with incremental face-down cards and a face-up top card; 24-card stock; waste starts empty; foundations empty.", "starting_player_rule": "human"}, "capture": {"type": "card_removal", "result": "When a move is executed, source cards are removed from their previous stack or moved to the destination; foundations accumulate cards; tableau cards flip face-down if uncovered", "directions": [], "chain_capture": false, "min_chain_length": 0, "require_sandwich": false, "capture_algorithm": {"name": "apply_move", "steps": ["Validate move via move_validation", "Apply changes to board state", "Flip face-down cards if needed", "Update foundations and tableau counts"], "inputs": ["row", "col", "current_player", "board", "parameters"], "outputs": {"affected_count": "int"}, "parameters": {"directions": [], "require_bounded": false, "min_chain_length": 0}}}, "scoring": {"method": "points", "winner_determination": "When all foundations reach King, human wins; if no moves and stock depleted, draw or loss as defined"}, "movement": {"range": "any", "allowed": "slide", "directions": ["up", "down", "left", "right"]}, "turn_flow": {"switch_after_move": true, "extra_turn_conditions": "end game after two consecutive passes", "pass_if_no_valid_move": true}, "move_validation": {"validity_checks": ["moves must place onto foundations or properly exposed tableau cards", "no invalid rank/colour jumps", "only face-up sequences may be moved as a unit", "stock to waste is allowed when tapping stock", "foundations must follow Ace to King in matching suit"], "must_place_on_empty": true, "validation_algorithm": {"name": "path_check", "steps": ["Identify source card(s) to move", "Validate selection is a legal sequence", "Check destination legality (foundation or tableau stacking rules)", "Ensure moves do not violate suit/rank sequence", "Produce a preview of resulting layout"], "inputs": ["row", "col", "current_player", "board"], "outputs": {"preview": "object", "is_valid": "boolean"}, "parameters": {"gravity": false, "directions": ["up", "down", "left", "right"], "require_bounded": true, "min_chain_length": 1}}}}, "technical": {"platform": "HTML5 Canvas", "performance": {"target_fps": 30, "max_load_time_ms": 1000, "max_ai_think_time_ms": 2000}}, "acceptance": [{"then": "Expected result with specific values", "when": "Human action performed", "given": "Initial state description"}, {"then": "State updates accordingly and logs move", "when": "Player performs a valid move", "given": "A valid move exists per Klondike rules"}, {"then": "AI uses simple algorithm, moves within 2s", "when": "AI calculates move", "given": "AI's turn, difficulty='easy'"}, {"then": "AI MUST execute a potential winning move", "when": "AI's turn, difficulty='hard'", "given": "AI can win in 1 move"}, {"then": "AI MUST block or prolong to prevent immediate win", "when": "AI's turn, difficulty='hard'", "given": "Human can win next turn"}], "end_conditions": {"win": [{"priority": "immediate", "condition": "All foundations complete", "check_logic": "Each foundation reaches King of its suit in order"}], "draw": [{"priority": "end_turn", "condition": "No legal moves and no possibility to progress within given seed", "check_logic": "Stalemate state with fixed seed"}], "lose": [{"priority": "end_turn", "condition": "No moves left and stock depleted", "check_logic": "No legal moves exist and stock is empty"}]}}