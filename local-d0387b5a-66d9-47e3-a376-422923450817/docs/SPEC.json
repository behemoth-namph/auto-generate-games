{"ui": {"feedback": ["Highlight valid moves", "Animate AI move", "Show AI thinking state", "Display winner/lose/draw messages"], "board_style": {"cell_size": 48, "disc_colors": {"outline": "#aaaaaa", "player_1": "#1e90ff", "player_2": "#ffffff", "librarian": "#8b5e3c"}, "flip_animation": {"enabled": true, "duration_ms": 180}, "grid_line_color": "#333333", "last_move_highlight": {"color": "#ffcc00", "enabled": true}, "valid_move_highlight": {"color": "#66ccff", "enabled": true}}, "interactions": ["Click to select a card; click a destination empty cell to move", "Drag to adjacent empty space to slide a card", "Click a stack to slide toward the queue", "Click restart to reset the game"], "display_elements": ["Board/game area", "Current player indicator (You vs AI)", "AI thinking indicator", "Game status message", "Queue progress indicator", "Restart button"]}, "meta": {"players": {"ai": 1, "human": 1}, "game_name": "Library Card Queue", "game_type": "board", "player_mode": "player_vs_ai", "core_mechanic": "Click a card to pick, then drag to an adjacent empty space or click a stack to slide one card toward the queue. The AI periodically adds a random librarian block to impede moves.", "session_minutes": [5, 20]}, "rules": [{"id": "R1", "text": "Clear, testable rule with input/output MUST define explicit error handling for illegal actions.", "type": "core"}, {"id": "R_AI_1", "text": "AI MUST make a move within 2 seconds of its turn starting.", "type": "core"}, {"id": "R_AI_2", "text": "AI with difficulty 'easy' MUST use a simple random or local heuristic to choose a legal slide.", "type": "core"}, {"id": "R_AI_3", "text": "AI with difficulty 'medium' MUST use a moderate heuristic considering block positions when selecting slides.", "type": "core"}, {"id": "R_AI_4", "text": "AI with difficulty 'hard' MUST use an advanced lookahead to anticipate human moves and block opportunities.", "type": "core"}], "state": {"board": {"type": "grid", "topology": "square", "neighbors": "up, down, left, right", "dimensions": [5, 5]}, "entities": [{"name": "Player", "properties": {"id": "1", "type": "human", "color": "#1e90ff", "pieces_played": "int"}, "initial_state": {"pieces_played": 0}}, {"name": "AI", "properties": {"depth": 1, "algorithm": "random_block_insertion", "difficulty": "easy", "is_thinking": false, "response_delay_ms": 500}, "initial_state": {"depth": 1, "algorithm": "random_block_insertion", "difficulty": "easy", "is_thinking": false, "response_delay_ms": 500}}, {"name": "Board", "properties": {"cols": "5", "grid": "2D array of cells; each cell holds occupantId|null and a type (card|librarian|empty)", "rows": "5"}, "initial_state": {}}, {"name": "Game", "properties": {"status": "string (playing|human_wins|ai_wins|draw)", "last_move": "object", "move_count": "int", "current_player": "int (1 or 2)"}, "initial_state": {"status": "playing", "move_count": 0, "current_player": 1}}]}, "turns": {"order": "Human (Player 1) → AI (Player 2) → repeat", "actions": [{"name": "player_move", "result": "Apply mechanics.move_validation and mechanics.capture; update board; update last_move; switch to AI; increment move_count; check end conditions", "condition": "current_player == 1 AND game.status == playing", "parameters": ["row", "col", "targetRow", "targetCol"]}, {"name": "ai_move", "result": "AI selects a legal slide or adjacent-move; applies mechanics.move_validation and mechanics.capture; updates state; switch to human; injects a librarian block every few turns; check end conditions", "condition": "current_player == 2 AND game.status == playing", "parameters": []}, {"name": "restart", "result": "Reset all state to initial values", "condition": "game.status != playing", "parameters": []}], "max_time_seconds": 30}, "config": {"show_ai_thinking": true, "default_difficulty": "medium", "ai_response_delay_ms": 500, "allow_difficulty_change": true}, "mechanics": {"setup": {"initial_placement": "Board initializes with a distribution of card tiles occupying the left side of the board and empty spaces on the right to enable sliding. Librarian blocks start as empty. The queue is conceptually outside the board along the designated exit edge.", "starting_player_rule": "human"}, "capture": {"type": "none", "result": "No capture mechanic; blocks only impede or allow slides", "directions": [], "chain_capture": false, "min_chain_length": 0, "require_sandwich": false, "capture_algorithm": {"name": "none", "steps": ["N/A"], "inputs": ["row", "col", "current_player", "board", "parameters"], "outputs": {"affected_count": "0"}, "parameters": {"directions": [], "require_bounded": false, "min_chain_length": 0}}}, "scoring": {"method": "none", "winner_determination": "End conditions determine the winner; no scoring is used"}, "movement": {"range": 1, "allowed": "slide", "directions": ["up", "down", "left", "right"]}, "turn_flow": {"switch_after_move": true, "extra_turn_conditions": "none", "pass_if_no_valid_move": true}, "move_validation": {"validity_checks": ["move targets an adjacent empty cell for single-card slide", "move may instead target a stack of adjacent cards that can slide toward the queue direction", "blocked by librarian blocks is invalid"], "must_place_on_empty": true, "validation_algorithm": {"name": "move_validation_logic", "steps": ["Identify target cell and occupant", "If target is empty and adjacent, allow slide of single card", "If target is occupied, check for stack slide toward queue and empty landing space", "Reject if landing space is blocked by librarian or board boundary", "Return is_valid and a preview of resulting board state"], "inputs": ["row", "col", "current_player", "board"], "outputs": {"preview": "object", "is_valid": "boolean"}, "parameters": {"gravity": "false", "directions": ["up", "down", "left", "right"], "require_bounded": "false", "min_chain_length": 1}}}}, "technical": {"platform": "HTML5 Canvas", "performance": {"target_fps": 30, "max_load_time_ms": 1000, "max_ai_think_time_ms": 2000}}, "acceptance": [{"then": "Expected result with specific values", "when": "Human action performed", "given": "Initial state description"}, {"then": "State updates: board occupancy, last_move, and move_count; legal moves recalculated", "when": "Player performs a moving action", "given": "A valid move exists per game rules"}, {"then": "AI selects a valid slide within 2 seconds and updates the board", "when": "AI calculates move", "given": "AI turn, difficulty='easy'"}, {"then": "AI MUST execute a winning move if available", "when": "AI's turn, difficulty='hard'", "given": "AI can win in one move"}, {"then": "AI MUST anticipate and block the human's immediate winning path if feasible", "when": "AI's turn, difficulty='hard'", "given": "Human can win next turn"}], "end_conditions": {"win": [{"priority": "immediate", "condition": "Human cards all successfully moved into the queue", "check_logic": "All human-owned card tiles reach the queue position; no legal moves remain for AI that would change this"}], "draw": [{"priority": "end_turn", "condition": "No legal moves exist for either side on a full turn", "check_logic": "End-turn check shows no legal moves for current player and the other side has no immediate winning path"}], "lose": [{"priority": "immediate", "condition": "AI blocks all paths to queue or no legal moves exist for human", "check_logic": "If human has no legal moves on their turn and the queue is not complete"}]}}